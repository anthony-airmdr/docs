---
title: "AWS GuardDuty"
description: "AWS GuardDuty is a threat detection service that continuously monitors your AWS accounts and workloads for malicious activity and unauthorized behavior. It helps you identify and respond to potential security threats."
---

### **Setup AWS GuardDuty**

<Steps>
  <Step title="Enable AWS GuardDuty">
    1. Go to your AWS account.
    2. Open the **GuardDuty console**: [AWS GuardDuty Console](https://console.aws.amazon.com/guardduty/).
    3. In the **GuardDuty dashboard**, click **"Enable GuardDuty"**.
    4. Choose whether to enable GuardDuty for:
       - Your **current AWS account** (for a single account setup).
       - **Multiple accounts** using AWS Organizations (if managing multiple accounts).
    5. Click **"Enable GuardDuty"**.
  </Step>
  <Step title="Set Up an S3 Bucket for Log Storage in AWS">
    1. **Go to S3 Console:** [AWS S3 Console](https://s3.console.aws.amazon.com/s3/home)
    2. Click **"Create bucket"**.
    3. **Enter a unique bucket name** (e.g., `my-security-logs-bucket`).
    4. Choose the **AWS Region** where you want to store logs.

       <Note>
         Make sure it is in the same region where GuardDuty is enabled.
       </Note>
    5. Click **"Create bucket"**.
    6. Configure the bucket with appropriate policies and permissions to allow GuardDuty to write logs to it.
    7. Attach a bucket policy that grants GuardDuty permission to write logs to the bucket.\
       Example Policy:

    
  </Step>
  <Step title="Configure a KMS Key Policy for AWS GuardDuty">
    AWS **KMS (Key Management Service)** is used to encrypt findings stored in Amazon S3 or other services.

    1. Open the **AWS KMS Console** â†’ [KMS Console](https://console.aws.amazon.com/kms/home).
    2. Select an existing KMS Key.\
       **or**
    3. Click **"Create Key"**.
    4. Select the **Symmetric** key.
    5. Choose **Encrypt and Decrypt** as the key usage.
    6. Click **Next**, give the key an alias (e.g., `GuardDutyKey`).
    7. In the Key policy section, choose Edit
    8. Add AWS GuardDuty service permissions to use your key
       - Copy the following policy block and add it to the Statement list in your KMS key policy

        
    9. Review & click **Create Key**.
  </Step>
  <Step title="Enable GuardDuty Findings Export to Amazon S3">
    ### Pre-requisites

    <Check>
      Ensure **GuardDuty is enabled** in your AWS account.
    </Check>
    <Check>
      An **Amazon S3 bucket** exists for storing findings
    </Check>
    <Check>
      Proper **IAM permissions** for GuardDuty to write to the S3 bucket.
    </Check>
    <Steps>
      <Step title="Configure Findings Export">
        1. Go to your [AWS GuardDuty Console](https://console.aws.amazon.com/guardduty/).
        2. In the settings, enable the export of findings to your S3 bucket.
        3. Specify the S3 bucket ARN and KMS key ARN of the same region.
      </Step>
    </Steps>
  </Step>
</Steps>

### Configure **GitHub Personal Access Token (PAT)** in AirMDR Integrations Dashboard

1. Navigate to [AirMDR](https://app.airmdr.com/auth/login), provide the credentials and click **Login.**

   ![](/images/Datadog11.png)
2. Navigate to the AirMDR Integrations Dashboard in the left navigation pane and select **Integrations.**\
   ![images/Duo7.png](/images/Duo7.png)
3. Use the search option, enter the keyword "**GitHub**", select the **Connections** tab, and click the **\+ Create** icon.\
   ![images/GitHub.png](/images/GitHub.png)
4. Enter the generated **organization ID,** provide the contents of the JSON file with Service Account credentials in the Authentication Details field params, and click **Create.**\
   ![images/GitHub2.png](/images/GitHub2.png)